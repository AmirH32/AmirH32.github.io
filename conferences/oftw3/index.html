<!DOCTYPE html>
<html lang="en" class="dark">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>OFTW3 - Amir&#39;s website</title>
        
        
        <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/favicon_io/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon_io/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon_io/favicon-16x16.png">
        <link rel="manifest" href="http://localhost:1313/favicon_io/site.webmanifest">        
        <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
        <link rel="preload" href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" as="style">
        
        
        <style>
            html, body {
                background-color: #121212;
                color: #f3f4f6;
            }            
            .border {
                border-color: #374151;
            }            
            .carousel-item {
                display: inline-block;
                margin: 0 1rem;
            }            
            .flex {
                display: flex;
            }
            .flex-col {
                flex-direction: column;
            }
            
            @media (min-width: 768px) {
                .md\:flex-row {
                    flex-direction: row;
                }
            }
            
            .tech-carousel {
                overflow: hidden;
                width: 100%;
                padding: 1rem 0;
            }

            ul, ol {
                list-style: revert !important;
                padding-left: revert !important;
                margin-left: revert !important;
                margin-bottom: 1rem !important;
            }

            li {
                display: list-item !important;
            }
  
            .carousel-track {
                white-space: nowrap;
            }
        </style>
        
        <script src="https://cdn.tailwindcss.com"></script>
        <link rel="stylesheet" type='text/css' href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />
        <script>
            
            if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        </script>
        <style>
            :root {
                color-scheme: dark;
            }
            
            body {
                @apply bg-[#121212] text-gray-100;
            }

            .tech-icon {
                filter: grayscale(100%) brightness(200%);
                transition: all 0.3s ease;
            }
            .tech-icon:hover {
                filter: none;
            }
            
            @keyframes scroll {
                0% {
                    transform: translateX(0);
                }
                100% {
                    transform: translateX(-100%);
                }
            }
            
            .tech-carousel {
                width: 100%;
                padding: 1rem 0;
            }
            
            .tech-track {
                width: fit-content;
                animation: scroll 20s linear infinite;
            }
            
            .tech-track:hover {
                animation-play-state: paused;
            }
            
            .tech-slide {
                float: left;
            }
        </style>
    </head>
    <body class="min-h-screen bg-[#121212] text-gray-100">
        
<head>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-C0RTF18BT4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-C0RTF18BT4');
    </script>
    
    <link rel="stylesheet" type='text/css' href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../css/custom.css">
    <style>
        body {
            font-family: 'Space Grotesk', sans-serif;
        }
    </style>
</head>
<header class="py-6 relative">
    <div class="max-w-6xl mx-auto px-4">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
            <div class="flex justify-between items-center">
                <a href="http://localhost:1313/" class="text-xl font-bold text-white hover:text-gray-300 transition-colors duration-300">
                    Amir
                </a>
                
                <button id="mobile-menu-button" class="md:hidden text-gray-300 hover:text-white focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>            
            
            <nav class="hidden md:flex flex-wrap justify-center items-center gap-4 md:gap-6">
                
                
                <a href="http://localhost:1313/about/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">About</a>
                
                <a href="http://localhost:1313/experience/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">Experience</a>
                
                <a href="http://localhost:1313/projects/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">Projects</a>
                
                <a href="http://localhost:1313/blogs/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">Blogs</a>
                
                <a href="http://localhost:1313/contact/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">Contact</a>
                
            </nav>
            <div class="hidden md:flex justify-end">
                <div class="flex items-center">
                    <span class="text-lg text-gray-300 mr-2">Local Time:</span>
                    <div id="local-time" class="text-lg text-gray-300"></div>
                </div>
            </div>
        </div>
    </div>

    
    <div id="mobile-menu" class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden transition-all duration-300">
        <div class="flex flex-col h-full">
            <div class="flex justify-between items-center p-6 border-b border-gray-800">
                <span class="text-xl font-bold text-white">Menu</span>
                <button id="mobile-menu-close" class="text-gray-300 hover:text-white focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <nav class="flex flex-col p-6 space-y-4">
                
                <a href="http://localhost:1313/about/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">About</a>
                
                <a href="http://localhost:1313/experience/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">Experience</a>
                
                <a href="http://localhost:1313/projects/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">Projects</a>
                
                <a href="http://localhost:1313/blogs/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">Blogs</a>
                
                <a href="http://localhost:1313/contact/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">Contact</a>
                
            </nav>
            <div class="mt-auto p-6 border-t border-gray-800">
                <div class="flex items-center justify-center">
                    <span class="text-lg text-gray-300 mr-2">Local Time:</span>
                    <div id="mobile-local-time" class="text-lg text-gray-300"></div>
                </div>
            </div>
        </div>
    </div>
</header>

<script>
    
    function updateLocalTime() {
        const timeElements = document.querySelectorAll('#local-time, #mobile-local-time');
        timeElements.forEach(element => {
            if (element) {
                const now = new Date();
                const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                element.textContent = timeString;
            }
        });
    }
    updateLocalTime();
    setInterval(updateLocalTime, 1000);

    
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenuClose = document.getElementById('mobile-menu-close');
    const mobileMenu = document.getElementById('mobile-menu');

    function toggleMobileMenu() {
        const isHidden = mobileMenu.classList.contains('hidden');
        if (isHidden) {
            mobileMenu.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; 
        } else {
            mobileMenu.classList.add('hidden');
            document.body.style.overflow = ''; 
        }
    }

    mobileMenuButton.addEventListener('click', toggleMobileMenu);
    mobileMenuClose.addEventListener('click', toggleMobileMenu);

    
    const mobileMenuLinks = mobileMenu.querySelectorAll('a');
    mobileMenuLinks.forEach(link => {
        link.addEventListener('click', () => {
            toggleMobileMenu();
        });
    });

    
    const themeToggleBtn = document.getElementById('theme-toggle');
    if (themeToggleBtn) {
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            themeToggleLightIcon.classList.remove('hidden');
            themeToggleDarkIcon.classList.add('hidden');
        } else {
            themeToggleLightIcon.classList.add('hidden');
            themeToggleDarkIcon.classList.remove('hidden');
        }

        themeToggleBtn.addEventListener('click', function() {
            themeToggleDarkIcon.classList.toggle('hidden');
            themeToggleLightIcon.classList.toggle('hidden');

            if (localStorage.getItem('color-theme')) {
                if (localStorage.getItem('color-theme') === 'light') {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                }
            } else {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                }
            }
        });
    }
</script> 
        <main>
            
<div class="w-1/2 mx-auto py-12">
    <div class="max-w-3xl mx-auto p-8 border border-gray-800 rounded-2xl bg-[#121212]">
        <h1 class="text-4xl font-bold mb-4">OFTW3</h1>
          <div class="flex items-center gap-4 mb-8 text-gray-400">
              <time datetime="2025-09-30">September 30, 2025</time>
              <span>•</span>
              <span>Estimated read time: 18 minutes</span>
              <div class="flex gap-2">
                  
              </div>
              
              <div class="ml-auto">              
                <span class="likebtn-wrapper" data-theme="ublack" data-ef_voting="push" data-rich_snippet="true" data-show_like_label="false" data-counter_frmt="comma" data-counter_count="true" data-popup_disabled="true" data-share_enabled="false" data-lazy_load="true" data-tooltip_enabled="false"></span>
                <script>(function(d,e,s){if(d.getElementById("likebtn_wjs"))return;a=d.createElement(e);m=d.getElementsByTagName(e)[0];a.async=1;a.id="likebtn_wjs";a.src=s;m.parentNode.insertBefore(a, m)})(document,"script","//w.likebtn.com/js/w/widget.js");</script>
                
              </div>

          </div>

        
        <nav class="prose prose-invert mb-8 border-l-4 border-gray-700 pl-4 max-w-none">
            <h2 class="text-xl font-semibold mb-2">Table of Contents</h2>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#an-intro-to-mac-malware-analysis---patrick-wardle">An Intro to Mac Malware Analysis - Patrick Wardle</a>
      <ul>
        <li><a href="#initial-access">Initial access</a></li>
        <li><a href="#persistence">Persistence</a></li>
        <li><a href="#payloads">Payloads</a></li>
        <li><a href="#file-types">File types</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#talk-1-iphone-backup-forensics">Talk 1: iPhone Backup Forensics</a></li>
    <li><a href="#talk-2-come-reverse-engineer-malware-with-me">Talk 2: Come Reverse Engineer Malware With Me</a></li>
    <li><a href="#talk-3-from-alert-to-action-investigating-a-real-security-incident">Talk 3: From Alert to Action: Investigating a Real Security Incident</a></li>
    <li><a href="#talk-4-mirror-mirror-restoring-reflective-code-loading-on-macos">Talk 4: Mirror Mirror: Restoring Reflective Code Loading on macOS</a></li>
    <li><a href="#talk-5-how-far-can-we-push-ai-for-detection">Talk 5: How Far Can We Push AI for Detection?</a></li>
    <li><a href="#talk-6-a-snake-in-the-apple-tree-bridging-python-and-objective-c-for-red-team-tradecraft">Talk 6: A Snake in the Apple Tree: Bridging Python and Objective-C for Red Team Tradecraft</a></li>
    <li><a href="#happy-hour">Happy hour</a></li>
  </ul>
</nav>
        </nav>
        
        
        <div class="prose prose-invert max-w-none">
            <p>My first &ldquo;objective for the win&rdquo; conference. I&rsquo;d seen this advertised in the CyberSecurity discord, for which I am now president, and decided this would be a great opportunity to learn more about Apply device security.</p>
<p>I&rsquo;d never looked into Apple security, neither do I own any Apple devices. So this was a first, I thought why not? I love security so I might as well explore and find out which niche I want to fall into.</p>
<h1 id="day-zer0">Day Zer0</h1>
<p>This day would be a workshop day in which we cover the essentials of Mac Malware analysis with the legend, Patrick Wardle. But prioer, I first had do take on some preparation, Objective See are focused on apple devices, so of course it&rsquo;s an i-device event. Do you see the issue yet?</p>
<p>Well <strong>I don&rsquo;t own any Apple devices</strong>. So what did I do? Well, I remembered something I had done in the past to ease my mum&rsquo;s transition from Mac to Linux (yes she now runs Linux as her daily-driver, all be it, she doesn&rsquo;t quite find enjoyment in ricing her system and writing cool utility bash scripts on a daily basis). Anyways back to the main point, I decided I would&hellip; run a hackintosh VM. Well easier said than done (because who reads the documentation until they fail countless times?).</p>
<p>So there&rsquo;s a cool project on github called OSX KVM, it&rsquo;s a simple install just run the: <code>fetch-macOS-v2.py</code> script. Now came the issue, I repeated the download process thrice because of this and each time took a good 2 hours. Do you know why? Because who reads documentation until they have failed for a good chunk of their time.</p>
<p>Anyway, tangent out of the way, let&rsquo;s get back to the day. Patrick&rsquo;s workshop day was heavily inspired by his book in terms of content and order (though I have to agree it&rsquo;s best to cover malware from it&rsquo;s initial access to its payload).</p>
<h2 id="an-intro-to-mac-malware-analysis---patrick-wardle">An Intro to Mac Malware Analysis - Patrick Wardle</h2>
<h3 id="initial-access">Initial access</h3>
<p>So we started off with a look at mac malware, its growth and infection vectors. From phishing links to 0day exploits we looked at all means of gaining initial access.</p>
<h3 id="persistence">Persistence</h3>
<p>From there we moved onto persistence, how does malware remain in a way such that even the good old fashioned classic of turning it &ldquo;off and on again&rdquo; doesn&rsquo;t work. It was during this section we looked at tradition login items, system agents, daemons and cronjobs. This is where my ear perked up because boy oh boy do I have experience with daemons and cron jobs, finally my script scheduling experience comes to use!</p>
<p>But, Mac does things differently, it stores these daemons in different directories, not the usual <code>/etc/systemd</code> (if you use systemd - some say it&rsquo;s bloatware). So we covered <strong>login items</strong>, <strong>launch items</strong>, <strong>cron jobs</strong>, <strong>login</strong> and <strong>logout hooks</strong>, <strong>kernel extensions</strong> (another parallel, after all Mac OS is UNIX based), <strong>browser plugins</strong> and many more.</p>
<h3 id="payloads">Payloads</h3>
<p>Then came payloads: <strong>browser script injectors</strong>, <strong>cryptominers</strong>, <strong>remote shells</strong>, <strong>remote execution</strong>, <strong>file exfiltrators</strong> and <strong>file encryptors (ransomware)</strong>.</p>
<p>This was followed by a lab that went through the content as well as the &ldquo;knock knock&rdquo; tool curated by Patrick himself. This tool identifies and highlights all persistent applications/programs.</p>
<h3 id="file-types">File types</h3>
<p>Next was an introduction to different MacOS specific file types as well as scripts. In case you haven&rsquo;t read my CTF write ups, we can use the <code>file</code> tool, similarly to Linux to identify files based of file headers.</p>
<p>MacOS also has its own version of disk image files: <code>.dmg</code> which you can then mount to your filesystem and explore.</p>
<p>Lastly comes another MacOS quirk, these being packages. Packages bundle all files and dependencies required by an application such as apple scripts (high level scripting language) or plist files (you&rsquo;ll meet these a lot). This was followed by another lab to re-enforce the knowledge.</p>
<p>You may notice a pattern in teaching used here: the use of supplementary labs to follow up every topic of learning. I found this great in consolidating my knowledge (though the labs were a little rushed). Nevertheless, as Patrick had mentioned, we could always follow up on the labs in our own time.</p>
<p>We then delved deeper into the Mach-O binary file and linked dependency libraries; a perfect segway into Static Binary Analysis.</p>
<p>A few flags to watch out for included:</p>
<ul>
<li>file hashes</li>
<li>Embedded ASCII strings</li>
<li>Code Signing (one of Mac&rsquo;s easily circumventable security features)</li>
<li>Packed binaries</li>
<li>Encrypted binaries</li>
</ul>
<p>This was accompanied by a whistle stop tour of low level programming by explaining the register convention, assembly and objective-c. Patrick&rsquo;s disassembler of choice was Hopper though Chris would disagree (I agree binary ninja is better!).</p>
<p>This was followed by a cool static analysis lab where instead of using these proprietary tools, let&rsquo;s use what the NSA developed: Ghidra!</p>
<p>It was around this point that we had successfully socially engineered Patrick to go off a tangent and tell us stories about his past, including his time at the NSA. He told us everything (I&rsquo;m just joking, NSA don&rsquo;t come after me).</p>
<p>Anyways for the stories that he did tell us, I&rsquo;ll leave it as an exercise for the reader - to attend one of his events, listen in and ask questions.</p>
<p>Amazing! I&rsquo;ve always wanted to pull off the &ldquo;I leave this as an exercise for the reader&rdquo;. It sure is great when the author (or my lecturer) is explaining an extremely complex topic and throws that into the mix, only for you to spend countless hours trying to figure it out (at least provide the solution).</p>
<p>Due to this tangent, Patrick had to skip the sections on the new ARM architecture that the latest Macs use. Instead, we moved on to dynamic analysis and of malware. This is where Patrick (rightfully) plugged his tools: <a href="https://github.com/objective-see/ProcessMonitor">ProcessMonitor</a>, <a href="https://github.com/objective-see/FileMonitor">FileMonitor</a> and <a href="https://github.com/objective-see/Netiquette">Netiquette</a>.</p>
<p>These tools are amazing when it comes to displaying process, file and network events respectfully, especially for malware detection and dynamic analysis on Mac. I never thought I&rsquo;d consider using a Mac but these tools might sweeten the deal when it comes to endpoint malware detection so thank you Patrick!</p>
<p>Essentially, you would use these tools to look out for anomalous processes running, file deletion/writing (indication of ransomware) and strange network traffic (usually connection to C2s). We also looked at the good old classic tool: Wireshark. You can never go wrong with Wireshark when it comes to network traffic monitoring and it is definitely a must-have for nearly all user needs.</p>
<p>Next came debugging an exceptionally important tactic in dynamic analysis. This would be useful in: decrypting strings (considering the malware does it for you) and analysing behaviour while controlling the program. Though I was already quite familiar with debuggers, given my experience with peda gdb when doing CTF challenges, I still found this section insightful.</p>
<p>Unfortunately, I had to leave as I could not delay my departure any further given my coach to catch. Nevertheless, the day was extremely enjoyable and I was sure to attend the next!</p>
<h1 id="day-0ne">Day 0ne</h1>
<p>The second day kicked off with a series of engaging talks from leading experts in Mac and iOS security. It was an eye-opening experience to hear directly from professionals who are actively working in the field - many of whom are involved in real-world red teaming, IR (incident response), malware analysis and security architecture.</p>
<p>Find all the talks and slides <a href="https://objective-see.org/oftw/v3.html">here</a>.</p>
<h2 id="talk-1-iphone-backup-forensics">Talk 1: iPhone Backup Forensics</h2>
<p>Speaker: Kinga Kieczkowska (@kieczkowska), Security Consultant at Rada Cyber Security <br>
📑 <a href="https://objective-see.org/downloads/oftw/v3/OFTW_v3_kKieczkowska.pdf">Slides</a> <br>
🎥 <a href="https://www.youtube.com/watch?v=SgAU6Vtll_c">Recording</a></p>
<p>The first talk provided a detailed overview of iPhone backup forensics. We started by looking at the process of creating an iPhone backup; it a hassle when compared to android (at least in my opinion considering I have an auto sync set up to my home server).</p>
<p>Kinga then covered the key files contained within a backup:</p>
<ul>
<li><code>Info.plist</code> for general information on the the device and its state (including installed apps) when the backup is taken</li>
<li><code>Status.plist</code> for metadata aboout the backup (e.g. eversion, creation start date etc)</li>
<li><code>Manifest.plist</code> for details on the application bundles on the device. It also contains a date, though Kinga is not sure what the date represents, I haven&rsquo;t had the chance to look into it so if you do know please reach out to me.</li>
<li><code>Manifest.db</code> which is an SQLite database file containing two tables. One of these tables being the files on the device (filterable by the unique hash fingerprint for the file).</li>
</ul>
<p>Kinga then noted some files of interest in case you are doing forensics which would be the databases in which your SMS messages, Notes and Whatsapp messages are stored.</p>
<p>She also made us aware of the open source backup analysis tool to aid in this process: <a href="https://github.com/abrignoni/iLEAPP">iLEAPP</a>.</p>
<p>Overall, this talk was brilliant, especially for someone who was not even aware that iPhones had a backup feature. I definitely found it insightful and interesting and now I definitely know where to look when I obtain someone&rsquo;s backup files (so make sure to encrypt yours!). Thank you Kinga, it was great!</p>
<h2 id="talk-2-come-reverse-engineer-malware-with-me">Talk 2: Come Reverse Engineer Malware With Me</h2>
<p>Speaker: Chris Lopez (@L0psec), Senior macOS Security Researcher at Kandji <br>
📑 <a href="https://objective-see.org/downloads/oftw/v3/OFTW_v3_cLopez.pdf">Slides</a><br>
🎥 <a href="https://www.youtube.com/watch?v=HfFX3S1-kmQ">Recording</a></p>
<p>Subsequently was Chris Lopez&rsquo;s talk and what it missed out on in the number of slides, it definitely made up in content and Chris made no secret of his strong appreciation of Binary Ninja.</p>
<p>This would be a reverse engineering session where we analysed the <a href="http://jamf.com/blog/signed-and-stealing-uncovering-new-insights-on-odyssey-infostealer/">Odyssey infostealer</a> malware sample. Specifically we analysed the dropper written in Swift, which the article linked had only mentioned in passing.</p>
<p>One of the biggest threats posed by this malware was due to the facts that it had been both code signed but also notorised by Apple themselves (something that Patrick had mentioned and also wrote at great lengths about in his book).</p>
<p>From the article, we can gather that the dropper presented a SwiftUI application that would reach out to a C2 server and retrieve an AppleScript payload using native Swift APIs before making this script downloadable and then executing it.</p>
<p>Looking at the sample, we can see that the symbols have been mangled during compilation. This is where Binary Ninja&rsquo;s plugin (Swift Demangler) came handy.</p>
<p>To understand that this is a Swift UI app we can easily look at it&rsquo;s dependent libraries and come to this conclusion. Chris then mentioned that since this UI app must spawn a process and there are only a few ways to do so using Swift, it will be easy to narrow down where this is done.</p>
<p>In this case, the malware used <code>NSTask</code> ObjectiveC class. One thing that I&rsquo;ll definitely give to Binary Ninja, that Chris made great use of was renaming subroutines and variables. Another cool thing I picked up here was the smooth integration of the lower-level ObjectiveC language with the higher level Swift language.</p>
<p>We began by looking within the function that used the <code>NSTask</code> class to spawn the process that set the privileges and executed the payload. This function simply appended together the command as a string before running it as a process. We then reversed through the caller functions to find the subroutine responsible for connecting to the C2 server using NSURLsession and the Swift hardcoded URL that is converted into an ObjectiveC URL: <code>hxxps://allteching[.]xyz/auto</code>.</p>
<p>By reverse engineering the program, we understood that the dropper reached out to the URL above in order to obtain a payload, for which it set permissions before executing.</p>
<p>One thing I didn&rsquo;t quite understand was as to why we added an offset of 20 to a large string&rsquo;s address to get the address to read the string from. If you do know this, please let me know.</p>
<p>Afterwards, I asked Chris as to why he loved Binary Ninja so much (rightly so, the UI and plugins are amazing) as well as about his BJJ background - considering I have started to pick up BJJ on my transition from boxing.</p>
<p>Thank you Chris for discussing BJJ at lengths with me as well as your journey to malware analysis.</p>
<h2 id="talk-3-from-alert-to-action-investigating-a-real-security-incident">Talk 3: From Alert to Action: Investigating a Real Security Incident</h2>
<p>Speaker: Shannon McCormick, Senior Incident Responder at Salesforce <br>
📑 <a href="https://objective-see.org/downloads/oftw/v3/OFTW_v3_sMcCormick.pdf">Slides</a><br>
🎥 <a href="https://www.youtube.com/watch?v=rhZ3F3ZgUe8">Recording</a></p>
<p>Shannon provided a talk on Incident response as well as a demonstration based on a true story she faced. Firstly, she outlined the responsibilities of incident response, then we looked at the MITRE ATT&amp;CK Framework to understand the Incident repsonse investigation process.</p>
<p>This involved looking for IOCs in the logs, forensics and some OSINT. In her example someone had been socially engineered by DPRK threat actors via the fake job interview on Linkedin method.</p>
<p>This was definitely a fun talk and something I&rsquo;d love to explore further considering the variety of hats you would have to pick up and thus the surplus knowledge to be gained.</p>
<p>Thank you Shannon for the truly insightful talk.</p>
<h2 id="talk-4-mirror-mirror-restoring-reflective-code-loading-on-macos">Talk 4: Mirror Mirror: Restoring Reflective Code Loading on macOS</h2>
<p>Author: Patrick Wardle, Founder, Objective-See Foundation <br>
📑 <a href="https://objective-see.org/downloads/oftw/v3/OFTW_v3_pWardle.pdf">Slides</a><br>
🎥 <a href="https://www.youtube.com/watch?v=gnS0Xkaj_tE">Recording</a></p>
<p>This was one of the talks I was most excited for, Patrick had hooked me in with the first day of Mac malware analysis and now I was desperate for more.</p>
<p>This talk would be on <strong>reflective &ldquo;in-memory&rdquo; code loading</strong> which is the execution of compiled code directly from memory with the payload never being written to disk (apparently if it is encrypted and written to disk then it&rsquo;s still reflective?).</p>
<p>Running payloads from memory is not as simple as copying it from secondary storage to memory (they have different underlying architecture). Now you may ask: isn&rsquo;t all code loaded to memory before being ran?</p>
<p>This is true and it&rsquo;s done by the loader that reads the binary from the disk and maps it and any dependencies (dynamic libraries) into memory. It then applies relocations and resolves symbols before excuting initialisers to initialise the environment for the binary and trasferring control to <code>main()</code>.</p>
<p>Initially malware used dyld&rsquo;s (the loader&rsquo;s) functionality to load binaries into memory however with dyld 3, this loader API would no longer load to memory without first writing the in-memory payload to the disk. The memory loading functionality was rarely used by genuine apps and therefore the deprecation was welcomed.</p>
<p>How can we get around this?</p>
<p>We could try using a RAM disk - allocate a section of RAM as if it were a filesystem - however these RAM disk actions still create file events as the OS treats the RAM disk as the ordinary filesystem nevertheless it still removes persistence.</p>
<p>We could try changing the file name in the template where the filename is written to the disk as part of the loader&rsquo;s API. This ensures it is no longer added to the loader default file location, we can now patch the loader, however a file (not the payload) is still created and the event does show up.</p>
<p>This is where Patrick thought of an ingenious solution of simply patching the previous dyld loader version and using it&rsquo;s vulnerable memory loading functionality we could essentially travel back in time to when things were all well and vulnerable.</p>
<p>For the final cherry on top, Patrick wanted some Objective C support and found an article called <a href="https://github.com/mull-project/llvm-jit-objc?tab=readme-ov-file">&ldquo;LLVM JIT, Objective-C and Swift
on macOS: knowledge dump&rdquo;</a> by Stanislav Pankevich on Objective C support in memory loaded code.</p>
<p>However, hardened Mac runtimes can protect against this as they enforce code signing which compares the memory binary&rsquo;s signature to the one on-disk to ensure the binary in-memory is code nsigned. To get around this, one can add exception entitlements to the custom loader, which many genuine applications do indeed utilise. All you would need to do after this is submit your custom loader for notarisation, which should happen as there is nothing inherently malicious about the loader and Apple have even notarised malware in the past.</p>
<p>As a malicious actor, why do we want reflective code loading?</p>
<p>Apple doesn&rsquo;t allow <strong>any</strong> process (including security tools) from reading the memory of other processes - for privacy reasons. However, this is an instance when privacy sacrifices security. This means there are no available detection protections in place for this and it remains a huge threat to Mac security. The only solution as of now would be for the monitoring and detection of payload behaviour.</p>
<p>Apple please provide trusted security tools with the ability to read memory completely. This will solve many issues.</p>
<p>Thank you Patrick for this talk, it was really interesting and now I know how I will go about commit to my master plan of a Mac port of memory-loading BonziBuddy on every Macbook across the world.</p>
<p>Small note:
It was also interesting to see GAUSS (anther memory loaded malware variant) that has remained a mystery since 2012 as it has never been decrypted.</p>
<h2 id="talk-5-how-far-can-we-push-ai-for-detection">Talk 5: How Far Can We Push AI for Detection?</h2>
<p>Author: Martina Tivadar, Research Assistant at iVerify<br>
📑 <a href="https://objective-see.org/downloads/oftw/v3/OFTW_v3_mTivadar.pdf">Slides</a><br>
🎥 <a href="https://www.youtube.com/watch?v=j7H79XTZU-s">Recording</a></p>
<p>This talk focused on the use of LLMs (with a comparison to previous machine learning classification models) to classify Mac malware.</p>
<p>Martina went through the entire pipeline from data collection by grabbing malware samples from the <a href="http://github.com/objective-see/Malware">Objective-see repository</a>, running the samples and then extracting a log of events using the Apple Endpoint Security Framework API.</p>
<p>We then went on to preprocessing, for classical machine learning models this would require encoding of categorical data, handling missing values, feature engineering, balancing the dataset and scaling data however, when using LLMs, all that was required was filtering the logs as they started off too large.</p>
<p>Martina decided the best methodology for this would be to prioritise recent activity and only keep significant data results.</p>
<p>There was then a brief explanation of LLMs as well as the different OpenAI models before we looked at prompt engineering.</p>
<p>This included 6 different prompt types:</p>
<ul>
<li><strong>Zero-shot</strong> where there is no extra instruction</li>
<li><strong>One-shot</strong> where an extra example is provided to the model</li>
<li><strong>Few-shot</strong> where a few examples are provided to &ldquo;teach&rdquo; the model the pattern</li>
<li><strong>Chain-of-thought</strong> where instructions on how the AI should reason and think is given step by step</li>
<li><strong>Negative</strong> where the model is told what not to do</li>
<li><strong>Hybrid</strong> a combination of the types listed above.</li>
</ul>
<p>Martina then did an experiment with two independent variables, those being the:</p>
<ul>
<li>OpenAI model (3 variants)</li>
<li>The prompt type</li>
</ul>
<p>The dependent variables that would be measured and reported were:</p>
<ul>
<li>Accuracy</li>
<li>Precision</li>
<li>Recall</li>
<li>F1 score</li>
</ul>
<p>The results were zero-shot prompting with no additional instructions worked <strong>best overall</strong> though the exact scores were not disclosed. It caught 100% of malware with a few false positives and in the case of malware a false positive is much better than a false negative.</p>
<p>Chain-of-thought and few shot prompts came next with one-shot and negative prompts doing worse. Though an interesting note was that one-shot and negative prompts had fewer false positives due to their caution but this resulted in many false negatives, which would let malware evade them.</p>
<p>Martina then ended the presentation off on how the use of LLMs have really condensed and simplified the machine learning pipeline making their use much more accessible.</p>
<p>During the happy hour mentioned below, I had asked Martina if tailor made machine learning models would perform better to which she answered that, surprisingly, performance was quite similar.</p>
<h2 id="talk-6-a-snake-in-the-apple-tree-bridging-python-and-objective-c-for-red-team-tradecraft">Talk 6: A Snake in the Apple Tree: Bridging Python and Objective-C for Red Team Tradecraft</h2>
<p>Author: Luke Roberts (@rookuu), Senior Red Team Engineer at GitHub and co-founder of Phorion <br>
📑 <a href="https://objective-see.org/downloads/oftw/v3/OFTW_v3_lRoberts.pdf">Slides</a><br>
🎥 <a href="https://www.youtube.com/watch?v=EQkAJ6yzkW4">Recording</a></p>
<p>This was the final talk of the day but definitely a really interesting one considering red teaming is one of my aspirations.</p>
<p>The talk covered using the <strong>Mythic</strong> open-source C2 framework (think of it like an alternative for cobalt strike) and <strong>Medusa</strong>, an open-source implant that speaks back to the Mythic C2 written in python.</p>
<p>Medusa has functionality for credential theft, persistence, keylogging, screenshots and sniffing clipboards. Luke focused on implementing a clipboard snipper for macOS as the functionality only worked for Python 2.7.</p>
<p>Now we could use libraries that run commands however this would stick out like a sore thumb in blue teams&rsquo; logs. If <code>pbpaste</code> was run by Python via a shell that&rsquo;s definitely something you would want to look into.</p>
<p>Objective-C APIs can be used instead as it&rsquo;s direct communication with the OS without running a boilerplate, bloat library on top that is easily detected.</p>
<p>Objective-C unlike C has a very powerful runtime instead of having all functionality implemented at the compiler level. This allows for dynamic, runtime changes for example adding methods to classes which is usually prohibited. You, the developer, have direct access to the runtime while the program runs. This means the compiler does not assign function pointers or mappings, since this is decided at runtime and the compiler calls the function for runtime.</p>
<p>So when the compiler calls a function, since the function may change, it uses a feature called <strong>message sending</strong>. E.g. <code>[mystring length]</code> sends a message <code>length</code> to the object <code>mystring</code>. The message is sent to the receiver through the <a href="https://developer.apple.com/documentation/objectivec/1456712-objc_msgsend"><code>obj_msgSend</code></a> function.</p>
<p>So we can use a C-based library to make Objective-C runtime calls but we want to implement a feature to make these calls in Python for the Mythic implant. Python has a great library <code>ctypes</code> to run C code in Python.</p>
<p>However, there is a lot of boiler plate code to complete simple behaviours, so Luke proposed creating an interface to abstract and hide all the boilerplate.</p>
<p>Luke then showcased a demo on running the code on the implant with the Mythic C2 platform.</p>
<h2 id="happy-hour">Happy hour</h2>
<p>I then spent the happy hour:</p>
<ul>
<li>Asking Luke for career direction advice (I&rsquo;m still not sure whether I want to specialise in malware analysis, red teaming or vulnerability research). Luke mentioned that I should further explore and learn which area I lean towards. For red teaming he recommended doing some bug bounties for actual practical experience instead of just hack the box as well as reading write ups for malware and vulnerability research.</li>
<li>Asking Patrick about why anti-malware tools don&rsquo;t check for different variants of loaders being used that are not in line with the current released loader. For which he answered, that would be a great idea for a tool and definitely something he would do if he created a tool with that within its scope. I then asked why Apple notarised this malicious loaders - allowing them to run - for which he had as much of an idea as me.</li>
<li>I had also asked Patrick: &ldquo;in terms of a bootstrapping perspective, how would the malware author ensure the payload that downloads and compiles the malicious loader is executed?&rdquo;&quot; He then responded that this would require stager/dropper to fetch and switch the loader so that we can use apples deprecated API to memory load our main payload</li>
</ul>

            
            
        </div>
    </div>
</div>

        </main>
        
<footer class="mt-32 text-center">
    <div class="max-w-3xl mx-auto">
        <div class="border-t border-gray-800 pt-5">
            <div class="flex flex-col items-center justify-center gap-2">                
                <p class="text-gray-500 text-xm ">© 2025 Amir</p>
                <p class="text-gray-500 text-xm pb-12">Built using <a href="https://gohugo.io/" target="_blank" class="animated-link text-gray-400 hover:text-gray-200">Hugo</a>. Take a look at my <a href="https://github.com/prxshetty/" target="_blank" class="animated-link text-gray-400 hover:text-gray-200">GitHub</a></p>
            </div>
        </div>
    </div>
</footer>

<style>
    .animated-link {
        position: relative;
        display: inline-flex;
        align-items: center;
    }
    
    .animated-link::after {
        content: '';
        position: absolute;
        width: 0;
        height: 1px;
        bottom: -1px;
        left: 0;
        background-color: #ffffff;
        transition: width 0.3s ease-in-out;
    }
    
    .animated-link:hover::after {
        width: 100%;
    }
</style> 
    </body>
</html> 
